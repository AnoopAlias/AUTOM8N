

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Administration of nDeploy plugin &mdash; nDeploy 3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="nDeploy 3.0 documentation" href="index.html"/>
        <link rel="next" title="Monitoring nginx and app servers" href="Monitoring.html"/>
        <link rel="prev" title="Setting up ColdFusion or Java" href="ColdFusion_Java.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> nDeploy
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Installation &amp; Basic Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mod_remoteip.html">mod_remoteip</a></li>
<li class="toctree-l1"><a class="reference internal" href="http_to_https_redirect.html">http to https redirection</a></li>
</ul>
<p class="caption"><span class="caption-text">Backends Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="HHVM.html">Setting up HHVM</a></li>
<li class="toctree-l1"><a class="reference internal" href="PHP.html">Setting up PHP</a></li>
<li class="toctree-l1"><a class="reference internal" href="PYTHON_WSGI.html">Setting up Python (WSGI app)</a></li>
<li class="toctree-l1"><a class="reference internal" href="RUBY_RACK.html">Setting up Ruby(Rack app)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NodeJS.html">Setting up NodeJS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Meteor.html">Setting up Meteor</a></li>
<li class="toctree-l1"><a class="reference internal" href="ColdFusion_Java.html">Setting up ColdFusion or Java</a></li>
</ul>
<p class="caption"><span class="caption-text">Administration &amp; Monitoring</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Administration of nDeploy plugin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#layer7-application-layer-ddos-mitigation">Layer7(Application layer) DDOS mitigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-fixing-of-most-errors">Automatic fixing of most errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managing-default-config-for-nginx-vhosts">Managing default config for nginx vhosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-selection-of-template-based-on-application-detection">Automatic selection of template based on application detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#providing-more-config-templates-or-profiles">Providing more config templates or profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrading-ndeploy-and-nginx">Upgrading nDeploy and nginx</a></li>
<li class="toctree-l2"><a class="reference internal" href="#temporarily-disable-the-plugin">Temporarily disable the plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uninstall-the-plugin">Uninstall the plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-nginx-ndeploy-from-source">Building nginx-nDeploy from source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Monitoring.html">Monitoring nginx and app servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logs.html">Managing Logs</a></li>
</ul>
<p class="caption"><span class="caption-text">nDeploy Cluster</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cluster_architecture.html">nDeploy cluster architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="nDeploy_cluster_setup.html">nDeploy cluster setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="Upgrade_cluster.html">nDeploy cluster upgrade</a></li>
</ul>
<p class="caption"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">nDeploy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Administration of nDeploy plugin</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/nDeploy_Administration.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="administration-of-ndeploy-plugin">
<h1>Administration of nDeploy plugin<a class="headerlink" href="#administration-of-ndeploy-plugin" title="Permalink to this headline">¶</a></h1>
<p>As a server administrator the following scripts are available for administration of the nDeploy plugin
All tools are to be used from commandline as root</p>
<div class="section" id="layer7-application-layer-ddos-mitigation">
<h2>Layer7(Application layer) DDOS mitigation<a class="headerlink" href="#layer7-application-layer-ddos-mitigation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">To</span> <span class="n">mitigate</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">ddos_mitigate</span><span class="o">.</span><span class="n">sh</span> <span class="n">enable</span>

<span class="n">To</span> <span class="k">return</span> <span class="n">config</span> <span class="n">to</span> <span class="n">normal</span> <span class="n">mode</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">ddos_mitigate</span><span class="o">.</span><span class="n">sh</span> <span class="n">disable</span>
</pre></div>
</div>
</div>
<div class="section" id="automatic-fixing-of-most-errors">
<h2>Automatic fixing of most errors<a class="headerlink" href="#automatic-fixing-of-most-errors" title="Permalink to this headline">¶</a></h2>
<p>The following script rebuilds all config and restarts backend app servers</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">/opt/nDeploy/scripts/attempt_autofix.sh</span></code></div></blockquote>
</div>
<div class="section" id="managing-default-config-for-nginx-vhosts">
<h2>Managing default config for nginx vhosts<a class="headerlink" href="#managing-default-config-for-nginx-vhosts" title="Permalink to this headline">¶</a></h2>
<p>The default config generation in nDeploy is governed by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">domain_data</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">tmpl</span>    <span class="o">===&gt;</span> <span class="n">For</span> <span class="n">non</span><span class="o">-</span><span class="n">SSL</span> <span class="n">domains</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">domain_data_SSL</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">tmpl</span>   <span class="o">==&gt;</span> <span class="k">for</span> <span class="n">SSL</span> <span class="n">domains</span>
</pre></div>
</div>
<p>It is set to PROXY to httpd and PROXY to httpd_SSL</p>
<p>You can change that behavior by creating the same filename ending in .local</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp -p /opt/nDeploy/conf/domain_data_SSL.yaml.tmpl /opt/nDeploy/conf/domain_data_SSL.yaml.tmpl.local
cp -p /opt/nDeploy/conf/domain_data.yaml.tmpl /opt/nDeploy/conf/domain_data.yaml.tmpl.local

change profile: &#39;1000&#39;   to profile: &#39;1005&#39; in /opt/nDeploy/conf/domain_data.yaml.tmpl.local
change profile: &#39;1004&#39;   to profile: &#39;1006&#39; in /opt/nDeploy/conf/domain_data_SSL.yaml.tmpl.local

rm -f /opt/nDeploy/domain-data/*   #will remove all domain-data files

for CPANELUSER in $(cat /etc/domainusers|cut -d: -f1)
    do
        echo &quot;ConfGen:: $CPANELUSER&quot; &amp;&amp; /opt/nDeploy/scripts/generate_config.py $CPANELUSER
    done
    service nginx restart
</pre></div>
</div>
<p>Similar to above ;if you change the backend to PHP and use Wordpress template;
all your domain will be served by nginx+php-fpm bypassing apache .
Of course, all your web apps must be WordPress in such cases .</p>
</div>
<div class="section" id="automatic-selection-of-template-based-on-application-detection">
<h2>Automatic selection of template based on application detection<a class="headerlink" href="#automatic-selection-of-template-based-on-application-detection" title="Permalink to this headline">¶</a></h2>
<p>The following script can detect the application installed in the webroot(only!) based on filenames</p>
<p>While cPanel users can always change the vhost configuration for nginX
anytime from their cPanel login
sometimes the server administrator want to automatically switch supporting applications
to be directly served by nginX instead of apache.</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">/opt/nDeploy/scripts/auto_config.py</span> <span class="pre">CPANELUSER</span></code></div></blockquote>
<p>does this.</p>
<p>The script works by checking the presence of certain files like for example the wp-config.php in case of wordpress and switches the profile accordingly</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@cpanel</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="c1"># cat /opt/nDeploy/conf/appsignatures.yaml</span>
<span class="n">SSLREDIRECT</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
<span class="n">PHP</span><span class="p">:</span>
  <span class="s1">&#39;/wp-config.php&#39;</span><span class="p">:</span> <span class="s1">&#39;5001&#39;</span>
  <span class="s1">&#39;/libraries/joomla/version.php&#39;</span><span class="p">:</span> <span class="s1">&#39;5002&#39;</span>
  <span class="s1">&#39;/sites/default/settings.php&#39;</span><span class="p">:</span> <span class="s1">&#39;5017&#39;</span>
  <span class="s1">&#39;/app/etc/local.xml&#39;</span><span class="p">:</span> <span class="s1">&#39;5003&#39;</span>
</pre></div>
</div>
<p>Admin can update the appsignatures.yaml file with file names and the corresponding
profile that auto_config.py switch the domain to if the file exists.
The default list provided by us is not extensive.
Admins can also remove entries from the file above to negate auto-switching should there be a need for it . SSLREDIRECT is a switch that can have value 0 or 1 and if it is set to 1 .All the non-ssl vhost conf generated by Nginx will have the redirect http to https template .
The file</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">/opt/nDeploy/conf/auto_config.exclude</span></code></div></blockquote>
<p>if present and contain the CPANELUSERNAME in it will prevent auto switching of profiles
for any domain (addon,subdomain etc) of the cpanel user.
This is useful while running the auto_config script in a for loop over a list of
cpanel users and if the script should omit any user.
To make this all work</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>1. Edit /opt/nDeploy/conf/appsignatures.yaml . Add or remove filenames (relative to document root) and the corresponding profile names to switch to should the file be present in document root

2. set SSLREDIRECT to 0 or 1 depending on how you want the non-ssl vhost to behave .We recommend the value be set to 1 as https:// is the norm of the modern world and redirecting non-ssl domains to ssl ones are good.

3.Create a file named /opt/nDeploy/conf/auto_config.exclude and add any cpanelusername for which you wish to exclude auto_config. If the file is not present or is empty ;no user is excluded

4.run

for CPANELUSER in $(cat /etc/domainusers|cut -d: -f1)
    do
        echo &quot;Auto ConfGen:: $CPANELUSER&quot; &amp;&amp; /opt/nDeploy/scripts/auto_config.py $CPANELUSER
    done
    service nginx restart
</pre></div>
</div>
<p>The first time auto_config.py runs it will ask your preference of PHP version
that automatic switching should use.
On cpanel servers you can safely use the same version as the default installed PHP
as most of your domains will be running that version without issues</p>
<p>A very IMPORTANT thing to note here is that auto_config.py is doing an educated guess work
and determining the application that is installed .
It MAY NOT! be always accurate . The administrator must be aware of this .
Of course, any change made by the auto_config can be reverted by the end user
or the admin from the cPanel plugin UI.</p>
</div>
<div class="section" id="providing-more-config-templates-or-profiles">
<h2>Providing more config templates or profiles<a class="headerlink" href="#providing-more-config-templates-or-profiles" title="Permalink to this headline">¶</a></h2>
<p>To avoid clashes between user defined template and rpm provided ones . the following numbers will be reserved for user defined templates</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">N600</span> <span class="o">-</span><span class="n">N999</span>
<span class="mi">9000</span> <span class="o">-</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>Where N is an integer . So, for example, the rpm provided templates will never use the range 2600 - 2999
New config templates can be provided to end users by the admin by simply adding
a file with all the location blocks, rewrite rules etc for an application .</p>
<p>The default template files can be found in</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@web</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="c1"># ls -l /opt/nDeploy/conf/*.tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">596</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">1000.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">1452</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">1001.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">148</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">2001.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">152</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">3001.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">152</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">4001.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">210</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">4002.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">359</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">5001.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">806</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">5002.</span><span class="n">tmpl</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>  <span class="mi">1810</span> <span class="n">Jun</span> <span class="mi">26</span> <span class="mi">04</span><span class="p">:</span><span class="mi">42</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="mf">5003.</span><span class="n">tmpl</span>
</pre></div>
</div>
<p>Each programming language should begin with a specific number ( eg: 5xxx for PHP ) for clarity purpose</p>
<p>You can easily base a new template on an existing template by adding or removing new location blocks, rewrite rules etc</p>
<p>Once a template file is added in /opt/nDeploy/conf/ .</p>
<p>It needs to be registered using the following command which is an example of how we registered the Magento template</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@web</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="c1"># /opt/nDeploy/scripts/update_profiles.py -h</span>
<span class="n">usage</span><span class="p">:</span> <span class="n">update_profiles</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span>
                          <span class="n">backend_category</span> <span class="n">profile_code</span>
                          <span class="n">profile_description_in_doublequotes</span>

<span class="n">Register</span> <span class="n">a</span> <span class="n">nginX</span> <span class="n">config</span> <span class="n">profile</span> <span class="k">for</span> <span class="n">nDeploy</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">backend_category</span>
  <span class="n">profile_code</span>
  <span class="n">profile_description_in_doublequotes</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>

<span class="n">root</span><span class="nd">@web</span> <span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="c1"># /opt/nDeploy/scripts/update_profiles.py PHP 5003 &quot;Magento&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="upgrading-ndeploy-and-nginx">
<h2>Upgrading nDeploy and nginx<a class="headerlink" href="#upgrading-ndeploy-and-nginx" title="Permalink to this headline">¶</a></h2>
<p>nDeploy-nginx is mated with a phusion passenger ruby gem .
So we don&#8217;t encourage unmanned upgrades and have therefore set enable=0 in the yum repository .
The upgrade must be done manually by running the following commands</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">AnoopAlias</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">centos</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">3.</span><span class="n">noarch</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">yum</span> <span class="o">--</span><span class="n">enablerepo</span><span class="o">=</span><span class="n">ndeploy</span> <span class="n">install</span> <span class="n">nginx</span><span class="o">-</span><span class="n">nDeploy</span> <span class="n">nDeploy</span>
<span class="c1">#For setups using Phusion Passenger app server</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">nginx</span><span class="o">-</span><span class="n">passenger</span><span class="o">-</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
<span class="c1">#For upgrading PHP application server(additional packages are to upgraded via yum)</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">easy_php_setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="temporarily-disable-the-plugin">
<h2>Temporarily disable the plugin<a class="headerlink" href="#temporarily-disable-the-plugin" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><code class="docutils literal"><span class="pre">/opt/nDeploy/scripts/cpanel-nDeploy-setup.sh</span> <span class="pre">disable</span></code></div></blockquote>
</div>
<div class="section" id="uninstall-the-plugin">
<h2>Uninstall the plugin<a class="headerlink" href="#uninstall-the-plugin" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">cpanel</span><span class="o">-</span><span class="n">nDeploy</span><span class="o">-</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span> <span class="n">disable</span>
<span class="n">yum</span> <span class="n">remove</span> <span class="n">nginx</span><span class="o">-</span><span class="n">nDeploy</span> <span class="n">nDeploy</span>
</pre></div>
</div>
</div>
<div class="section" id="building-nginx-ndeploy-from-source">
<h2>Building nginx-nDeploy from source<a class="headerlink" href="#building-nginx-ndeploy-from-source" title="Permalink to this headline">¶</a></h2>
<p>nDeploy is a collection of scripts and contains no binary file.
nginx-nDeploy is distributed as a binary application .</p>
<p>While using the nDeploy RPM repository is the easiest and fastest way to get nDeploy on your server . You may sometimes wish to compile your own RPM&#8217;s</p>
<p>The reason why one may wish to do this is</p>
<ol class="arabic simple">
<li>Add /extend nginX with more plugins</li>
<li>If you don&#8217;t trust the nginX binary compiled on our server.</li>
<li>You notice an error and wish to debug nginX . <a class="reference external" href="https://www.nginx.com/resources/wiki/start/topics/tutorials/debugging/">https://www.nginx.com/resources/wiki/start/topics/tutorials/debugging/</a> , which requires that you compile Nginx with the –with-debug flag .</li>
<li>For the fun (and knowledge) of doing it</li>
</ol>
<p>The instructions for creating your own nginX rpms are listed below. Run the following on your cPanel server</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">AnoopAlias</span><span class="o">/</span><span class="n">nDeploy</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">nDeploy</span><span class="o">/</span><span class="n">rpm_buildtree</span><span class="o">/</span>
<span class="c1">#Open nDeploy-nginx_build_script.sh (for CentOS6 rpm) or nDeploy-nginx_build_script.centos7.sh (centos7) in a text editor</span>
<span class="c1">#The line starting with ./configure --prefix=/etc/nginx</span>
<span class="c1">#is what you have to modify to add or remove configure arguments</span>
<span class="c1"># comment out the line rsync -av nginx-nDeploy-* root@rpm.piserve.com:/home/rpmrepo/public_html/CentOS/7/x86_64</span>
<span class="n">root</span><span class="nd">@cpanel</span> <span class="p">[</span><span class="o">~/</span><span class="n">nDeploy</span><span class="o">/</span><span class="n">rpm_buildtree</span><span class="p">]</span><span class="c1"># ./nDeploy-nginx_build_script.centos7.sh</span>

<span class="n">It</span> <span class="n">will</span> <span class="n">take</span> <span class="n">some</span> <span class="n">time</span> <span class="n">to</span> <span class="n">build</span> <span class="o">.</span> <span class="n">Once</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">complete</span> <span class="n">you</span> <span class="n">will</span> <span class="n">have</span> <span class="n">the</span> <span class="n">nginx</span><span class="o">-</span><span class="n">nDeploy</span> <span class="n">rpm</span> <span class="n">inside</span> <span class="n">nginx</span><span class="o">-</span><span class="n">pkg</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">centos7</span><span class="o">/</span> <span class="p">(</span><span class="k">for</span> <span class="n">centos7</span><span class="p">)</span>
<span class="ow">or</span> <span class="n">nginx</span><span class="o">-</span><span class="n">pkg</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span> <span class="p">(</span><span class="n">centos6</span><span class="p">)</span> <span class="n">folder</span> <span class="o">.</span> <span class="n">which</span> <span class="n">you</span> <span class="n">can</span> <span class="n">install</span> <span class="n">using</span> <span class="n">rpm</span> <span class="o">-</span><span class="n">Uvh</span> <span class="n">command</span>
</pre></div>
</div>
<div data-disqus-identifier="Administration of nDeploy plugin" data-disqus-shortname="ndeploy-readthedocs-io" id="disqus_thread"></div></div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Monitoring.html" class="btn btn-neutral float-right" title="Monitoring nginx and app servers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ColdFusion_Java.html" class="btn btn-neutral" title="Setting up ColdFusion or Java" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Anoop P Alias.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/disqus.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>