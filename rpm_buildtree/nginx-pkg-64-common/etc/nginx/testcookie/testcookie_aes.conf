# testcookie off;
# testcookie_arg "";
# DO NOT ADD $http_host to testcookie_session parameter!!!!
testcookie_name BPC;
testcookie_secret JeEKCA9NtZ3OZFlWXdRP;
testcookie_session $remote_addr$http_user_agent;
testcookie_max_attempts 3;
testcookie_fallback /cookies.html?backurl=http://$host$request_uri;
testcookie_get_only off;
testcookie_p3p 'CP="CUR ADM OUR NOR STA NID", policyref="/w3c/p3p.xml"';
testcookie_redirect_via_refresh on;
testcookie_refresh_encrypt_cookie on;
testcookie_refresh_encrypt_cookie_key random; #change it by cron
testcookie_refresh_encrypt_cookie_iv random; #change it by cron

testcookie_refresh_template '<html><head><style>.loader-walk{width: 100px; height: 40px; position: absolute; top: 50%; left: 50%; -webkit-transform: translate(-50%, -50%); -ms-transform: translate(-50%, -50%); transform: translate(-50%, -50%);}.loader-walk > div{content: ""; width: 20px; height: 20px; background: #2196F3; border-radius: 100%; position: absolute; -webkit-animation: animate 2s linear infinite; animation: animate 2s linear infinite;}.loader-walk > div:nth-of-type(1){-webkit-animation-delay: -.4s; animation-delay: -.4s;}.loader-walk > div:nth-of-type(2){-webkit-animation-delay: -.8s; animation-delay: -.8s;}.loader-walk > div:nth-of-type(3){-webkit-animation-delay: -1.2s; animation-delay: -1.2s;}.loader-walk > div:nth-of-type(4){-webkit-animation-delay: -1.6s; animation-delay: -1.6s;}@-webkit-keyframes animate{0%{left: 100px; top: 0;}80%{left: 0; top: 0;}85%{left: 0; top: -20px; width: 20px; height: 20px;}90%{width: 40px; height: 15px;}95%{left: 100px; top: -20px; width: 20px; height: 20px;}100%{left: 100px; top: 0;}}@keyframes animate{0%{left: 100px; top: 0;}80%{left: 0; top: 0;}85%{left: 0; top: -20px; width: 20px; height: 20px;}90%{width: 40px; height: 15px;}95%{left: 100px; top: -20px; width: 20px; height: 20px;}100%{left: 100px; top: 0;}}</style><title>Loading</title></head><body><script type="text/javascript" src="/aes.min.js" ></script><script>function toNumbers(d){var e=[];d.replace(/(..)/g,function(d){e.push(parseInt(d,16))});return e}function toHex(){for(var d=[],d=1==arguments.length&&arguments[0].constructor==Array?arguments[0]:arguments,e="",f=0;f<d.length;f++)e+=(16>d[f]?"0":"")+d[f].toString(16);return e.toLowerCase()}var a=toNumbers("$testcookie_enc_key"),b=toNumbers("$testcookie_enc_iv"),c=toNumbers("$testcookie_enc_set");document.cookie="BPC="+toHex(slowAES.decrypt(c,2,a,b))+"; expires=Thu, 31-Dec-37 23:55:55 GMT; path=/";document.location.href="$testcookie_nexturl";</script><div class="loader-walk"> <div></div><div></div><div></div><div></div><div></div></div></body></html>';

testcookie_whitelist {
	include testcookie/whitelist_ips.txt;
}